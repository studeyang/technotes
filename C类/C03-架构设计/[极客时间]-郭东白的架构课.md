> 来源极客时间《郭东白的架构课》

# 开篇词｜没有战略意图，就成不了一个顶尖的架构师

**架构师要有战略意图和思考力**

我写下的这些架构方法论并不是独特的发明创造。它们都很朴素、简单。它们在二十年前就已经存在，现在依然存在。它们在我身上适用，在我近距离观察到的其他优秀架构师身上也适用。

我下决心写这个专栏的原因，是想把我对这些原则思考的路径和推导的过程写出来，以提升你作为架构师的判断力和思考质量。

架构师不仅需要关注当下流行什么，要选择什么方案、用什么开源框架，更需要有战略意图和思考力，比如：

- 在一个架构活动中到底应该关注什么？干预什么？
- 如何通过架构方案为团队或企业创造价值？
- 如何在各种资源条件的制约下，去实现架构目标？
- 如何通过价值创造让自己变得不可或缺？

对这些问题的回答，可以让你在架构师的职业成长过程中有一个明确的方法论和取舍，让你对自己的职业成长有更清晰的路径规划，让你少走一些弯路，多一些成功机会。

通过这门课，我期望能帮助你在架构师的成长这件事情上定义一个战略，提升你做架构师的成功概率。

**建立你的架构师成长战略意图**

我有一个坚信的理念：要想在架构师这个职业上超越别人，你必须要尽早建立好你的架构师成长战略。我借用企管学者哈莫与帕哈拉德（Hamel & Prahalad）在 Strategic Intent 这篇文章里提到的一个概念：“过去 20 年中达到世界顶尖地位的公司，每一家都有战略意图（Strategic Intent）”。

所谓战略意图，就是拥有与其资源和能力极不相称的雄心壮志。哈莫与帕哈拉德还特别提到，只有这种极度的不相称性，才会让一个公司愿意突破常规，为自己创造机会，成功挑战不可能。

我想这么来定位我的整个课程：“假设你有做一个全球顶尖架构师的战略意图，那么你在我的思考之上开始你的架构师生涯，我相信你会比不具备这些思考的人更有优势。”

**怎么设计这门课？**

那么，该怎么培养自己作为架构师的战略意图呢？

我先要给你一个我的答案：靠记忆和技能学习，是成不了一个好架构师的。真正的架构师成长，主要靠思考力的提升。所以，在这门课中，我不会也不能教你所谓的架构技能八法，给你现成的答案。而是会通过三种方法，来培养你的思考习惯，让你和我一起完成关于软件架构方法论和职业成长的思考。

第一，使用演绎法来寻找架构原理，而不是归纳法。

> 就跟做数学题一样，要理解解题过程，而不是仅仅知道题目的答案。

课程里的很多知识听起来都是常识，似乎不需要推导，但我会花很长篇幅去解释背景、引用定律，最后推导出一个行为模式或架构法则。虽然只学习最终推导出的结论，也可以帮助你成长。但更重要的是，我希望通过深度理解推导细节，锻炼你日常工作中运用演绎法来寻找规律的习惯。

第二，我会穿插一些基本的架构方法、思维工具和建模技能，来帮助你提升架构素养。

有两方面原因。首先，我发现我周围很多架构师由于不思考架构思维工具背后的意图，很难使用正确。如果使用不当，别人看一眼你的图，下意识就会觉得你缺少架构素养，那么你作为一个架构师的信任度就会被大打折扣。

其次，我个人坚信一个理念，就是软件架构虽然需要深度思考，但它更是一门实践的科学，必须学以致用。

第三，课程中会有大量案例，都是根据我的真实经历加工而成的。

之所以需要加工，是因为一个完整的真实案例，会有太多的支线信息。去掉这些，可以帮你理清主线。不过更关键的是，案例只是一种学习手段，启发思考才是学习的目的。

**我会怎么帮你设计战略意图？**

这个专栏分为四个模块，覆盖了架构师职业成长的四个不同维度。

模块一：六大生存法则

生存法则，就是你作为架构师必须要尊重的一些原则。如果违背，你指导的架构活动可能会面临巨大的失误，而你作为一个架构师的生存也会受到威胁。

![image-20230320225814632](https://technotes.oss-cn-shenzhen.aliyuncs.com/2023/202303202258672.png)

模块二：价值创造

价值创造指的是，从大型架构项目实施层面上考虑，你作为架构师必须要关注和干预一些重要的节点，然后在这个过程中去创造自己的增量价值。

我把架构活动分成八个节点：环境搭建、目标确认、可行性探索、架构规划、项目启动、阶段交付、全面上线和复盘。在每个节点中，你的每一步行动都会影响架构活动的成功率，这就是你给架构活动带来的真实贡献。

模块三：职业规划与成长

我把架构师的成长分解成五种能力，分别是：单个模块的设计能力、解决横向问题的能力、解决跨领域冲突的能力、全局性技术决策的能力，以及通过技术带来生存优势的能力。

同时，我也把架构师的成长角色分为四种，分别是兼职架构师、跨域架构师、总架构师和 CTO。

![image-20240517233520542](https://technotes.oss-cn-shenzhen.aliyuncs.com/2023/202405172335416.png)

你可能会问：为什么我这么早就要了解那些 CTO 才要面临的障碍呢？答案还是之前那句话：做架构师，战略意图很重要！

模块四：思考力

思考力，在我看来这是一个架构师生存最核心的能力，甚至可以说是未来任何职业的核心能力。

怎么提高思考力呢？我也没有标准答案。我只能提供一些我和团队提升思考质量的方法，包括逻辑思维、批判思维、逆向工程、反思、跨越边界和数据分析。这些概念比较抽象，所以我会通过大大小小的案例来示范我常用的思考路径，提高你的认知。

**开篇寄语**

我想强调的是：架构师没有速成班，架构师的成功主要靠思考力的提升。

所谓的致富速成班是让分享致富秘密的人迅速致富，来收智商税的。我期望你学习这门课时，先放弃速成的心态，静下心，认认真真地学习一下思维方式和架构原则，只有这样，才能提升你在未知环境中判断和取舍的质量，最终通过架构设计为你所在的团队或企业带来竞争优势。我认为这才是架构师成长中最重要的条件，是架构师的“渔”。

# ==模块一：六大生存法则==

# 01｜模块导学：是什么在影响架构活动的成败？

我们今天从分析架构活动开始，看看我笃信的生存法则，到底可以怎样保障你架构活动的成功。

**架构师的全部活动**

在整个软件架构的活动过程中，架构师首先要做的就是确定架构设计方案，这个方案需要和企业目标一致，与商业、软件环境相匹配，并且还需要满足各种资源的约束条件。而你作为一个架构师，要在这些方案中找到那个能够最小化资源和成本，最大化商业价值，以及最大化目标用户满意度的方案。最终，你还要组织技术团队交付这个架构设计方案。

如图所示，展示了架构师的全部活动，按照颜色分类，主要包括三个部分。

![image-20230530220824763](https://technotes.oss-cn-shenzhen.aliyuncs.com/2023/202305302208805.png)

中间白色部分是架构师的决策领域，包括架构方案和架构活动。

黄色部分指架构师的输入和输出部分。我们架构师必须时刻关注自己的输入和输出，它们是保证架构活动成功的前提。

蓝色部分指架构师的工作环境，主要包括企业所处的商业环境，如竞争、市场、监管等；企业内部的技术环境，如交互设备、sensor 网络、计算环境、外部的数据源等；以及企业和团队的文化环境。环境在很大程度上会影响架构方案的选择和实施路径，但同时也是大部分架构师最容易忽略的考量因素。

当我们把架构师的活动归纳总结后，很容易就能清楚到底是什么在影响整个架构活动的成败。我将它们总结归纳为六个要素，分别是：目标、资源、行为、天时、地利以及人和。

**架构活动成败的六个要素**

第一个要素是<mark>目标</mark>。确定目标应该是架构规划的起点，因此我们生存法则的第一条，就是教你如何去理解和干预这个目标，确保最终的架构活动能够为你所在的团队或企业带来价值。否则目标错了，你的项目永远也没办法成功。

第二是<mark>资源</mark>。我在大多数企业里，甚至包括非盈利型组织，都需要关注有限资源的利用率，以及架构活动最终可以带来的商业回报。我们生存法则的第三条，是关于你应该如何通过架构活动来最大化你所贡献的商业价值的。否则资源不足或者是消耗太快，你的项目也同样无法成功。

第三是<mark>行为</mark>。有了目标，有了足够资源，如果你还有正确的做事方式，那你就能逐步逼近正确的架构方案，并且指导团队完成它。

做成一件事情，如果周边条件成熟，环境好，那么事情就会进行得很顺利。反过来，如果条件不成熟，或者你逆势而为，那就会很艰难。架构活动也一样，影响它成败的要素也有天时、地利和人和。

先说<mark>天时</mark>，这里指的是商业环境和技术环境的变化趋势。环境复杂多变，那么看清楚变化趋势的本质，就可以让我们的架构决策顺势而为，借助于环境的变化来成就我们的团队、企业。这正是我们第四个生存法则要覆盖的内容。

再讲<mark>地利</mark>，就是你作为一个架构师待的地方，你所在企业的文化环境，这是我们作为架构师无法改变的部分。虽然没法改变，但“良禽择木而栖”。那么第六条法则就会帮助你选择最有利于架构师职业发展的文化环境，最大化你的成长。

最后讲<mark>人和</mark>，在上图中标注为 2，架构活动中涉及的人主要是研发人员和目标用户。在输入端，架构师需要与多个研发团队协作，因而理解研发方的核心诉求就尤为关键。在输出端，架构师产出方案的最终评判即目标用户的长期满意度。因此深度洞察用户的人性就是保证架构活动成功的关键所在。这是我们第二个生存法则要覆盖的内容。

**架构师的生存法则**

简单来说，生存法则指的是我们作为架构师在设计架构方案和组织架构活动时必须要尊重的一些原则。如果违背这些原则，那么作为一个架构师的生存就会受到威胁。

如何利用生存法则，最大化架构师的成长？我先简单陈述一下这六个法则的核心内容，然后再讲你应该怎么学习和应用这些法则。

第一条，架构师必须保障整个架构活动<mark>有且仅有一个正确的目标</mark>。这是架构活动的起点，也是甄别架构方案的主要依据，所以架构师有义务影响和干预这个目标，以确保目标本身的正确性。

第二条，架构活动需要<mark>尊重和顺应人性</mark>。架构活动既要服务用户，也要组织研发人员协同工作。这就意味着架构师必须洞察研发人员和目标用户的人性。从人性角度出发来做决策，才能保障最终面向用户的方案具有长期正确性，以及面向研发同学的实施过程具有可行性。

第三，架构师永远需要<mark>在有限资源下最大化商业价值</mark>。对于任何一个架构活动来说，架构师的可用资源，包括商业成本、研发成本、时间成本、迁移成本等，都是极其有限的，所以架构活动必须在这些限制条件下，最大化商业价值。

第四，架构选型必须要考虑到所依赖<mark>技术模块的生命周期</mark>。在架构设计的过程中，架构师会有一个技术选择空间。那么在这个选择空间内，理解、顺应且利用好技术周期就至关重要。也就是说，架构师要看准技术趋势，一般情况下，要选择已经有规模优势或者是即将有规模优势的技术，而不是选择那些接近衰老期的技术。

第五，架构师需要在架构活动中不断干预活动的目标和内容，以同时保证整个架构活动可以<mark>为企业注入外部适应性</mark>。这是架构师个人能在架构活动中创造的核心价值，而且也是架构师职业成长的必须，甚至也是架构师的荣耀所依赖。最终正确的架构选型会因为有很强的外部适应性而长期存在。

第六，架构师需要<mark>在一个相对安全的文化环境中探索未知</mark>，只有这样，才有希望找到正确的架构方案。文化环境是架构师最难影响的，因而架构师要有足够的判断力，认清自己所在的文化环境是否有利于探索正确的架构方案，不要在一个错误的环境中浪费自己的宝贵生命。

**学习这个模块的基调**

我期望你用一种完全不同的方式来学习这个模块：请你不要简单地相信或者背诵这些生存法则，而是跟我一起解释到底是什么原因让我把某个规律当成架构师的生存法则。也就是说，当你学习整个模块的时候，你需要试图理解我是如何被我所经历的事件教育的，并由此推断出这些生存法则的适用环境。

# 02｜法则一：为什么有些架构活动会没有正确的目标？

**架构活动为什么需要目标？**

我们公司目前大多使用 Kafka 来做架构，但有一位架构师认为开源社区里正流行的 Pulsar 的设计理念与云原生趋势十分契合，值得在全公司推广。于是他经过多方调研，搭建了一套系统预研，并针对一些小场景做了测试。测试结果很让人满意，他便整理了一套 PPT 来找我做汇报。

他的 PPT 写得非常好，无论是 Pulsar 的设计亮点还是对我们公司的迁移场景，思考得都很全面，我从中也收获不少。但当我问他：“你这么做的目标是什么？”，他显然没有料到我会问这样一个问题，所以在沉默了一阵子之后才说：“技术先进性？”

事实上，在一个企业里，技术先进性很少会是一个架构活动的正确目标，所以很多人做架构升级都只是为了做而做。从我过去二十多年的架构经验来看，一半以上的架构活动在发起之前都没有明确的目标。这种架构活动执行到最后，多个协同模块之间必然是一个散乱的结构，如下图所示。

![](https://technotes.oss-cn-shenzhen.aliyuncs.com/2023/202305302302745.png)

如果在初期就有一个明确的目标，那么做到最后，子模块和初期目标就会是大致对齐的，同时也会最大化对目标的贡献。

这正是我要讲的架构师的第一条生存法则：所有的架构规划必须有且只有一个正确的目标，而且它必须与公司的战略意图相匹配，这是你架构设计的起点。否则，系统就会变得复杂和无序，缺少结构性。

目标缺失是由多种原因造成的，刚才我们讲的情形只是其中一种表现。接下来，我就来讲讲目标缺失具体有哪些根因。下节课，再来提供你作为一个架构师的具体应对思路。

**目标缺失的两大根因**

关于目标缺失的根因，我们可以从技术和业务两个维度来寻找。

- 技术上：目标缺少全局视角

由于技术原因导致的目标缺失往往有个非常积极正面的出发点：那就是==技术同学对于先进技术的强烈好奇心。==

我曾在一个不到 700 人的研发团队里，看到过 8 个自动化 BI 报表工具、5 套 UI 组件、十多套工作流引擎。对于日常运维、软件升级、安全、合规和审计而言，这简直就是灾难。我相信在这些技术设计之初，从开发同学的视角来看，或多或少都有一些技术先进性的理由。但同时我也可以断定，引入这些技术时很少有人思考过全局复杂性。这就导致整个企业的软件从一个同构的系统迅速衰变成一个混乱无章的大杂烩。

引入这些技术的背后，其实还有一个不太光彩的原因，那就是==开发者的个人利益。==举个例子，这个团队曾经有个做大数据的负责人，匆忙引入了开源领域的一个新框架，并在会议上作了个演讲。但是讲完之后没多久就提了离职，留下个做了一半的烂尾项目。

也就是说，开发者的个人喜好、技术能力，甚至与其他开发者的关系，也会影响到自己是否会引入一个新系统。

在技术层面上，还有另外一个常见的原因，就是==信息沟通不畅。==因为层级低的技术同学很少做跨团队跨部门沟通，一些小范围的架构改造也找不到一个官方版本可以借用，而且从头开始的时候，总觉得别人的设计太复杂，有过度设计的嫌疑，所以都是自己去新写一个版本。而一旦业务逐渐增长，小工具长成了大工具，就变成了一个新的变种。

总结来说，从技术维度去思考目标缺失的根因，就在于缺少全局视角，主要有三方面的表现：技术同学对于先进技术的强烈好奇心，开发者的个人利益，以及信息沟通不畅。

- 业务上：目标太多、不明确

比技术原因更常见的是业务原因，主要表现在：目标太多、目标不明确或者是目标摇摆不定。

比如业务 leader 有一个极具创意的方案，但业务压力大，市场调研的准确度也很难判断，所以多数时间需要==靠 A/B 测试来决定这个方案是否要推广==。可以看到，业务同学连需求之间的一致性和相容性都没搞清楚，就把需求一个接一个地转给技术同学。在这种大量 A/B测试的背景下，业务逻辑层层累积，系统变得越来越臃肿，老代码谁都不敢删。

还有一种情形在大公司里比较常见。有的 CEO 喜欢高举高打，上任之后先==大搞运动==。我曾经见过一个 CEO，他在一个季度里同时启动 10 个项目，目标五花八门。几乎是把整个部门分成了十个子公司，让他们各自为战。在巨大的交付压力之下，团队根本来不及做统一规划，每个项目各自为战，整个季度几乎全员 997。

还有一种情形不太常见，但却极端致命，值得我们重视。那就是==一个公司有两个明确的目标==，这有点像华山派的剑宗和气宗之争。

举个例子，在一个做电商的公司中，剑宗会认为做业务要像自营一样对整个供应链做强管控，这样会有更好的用户体验，以获取更多的市场份额；气宗则认为道法自然，做业务就要走开放的平台模式，最大化平台的丰富度，由用户选择来淘汰落后的商家。

两派自然是互不服气。如果剑宗上位，公司就大兴剑宗玩法，一切设计都走供应链路线。如果剑宗连续折戟，那么气宗上位，之前的一切设计都推倒重来，全走平台模式。

事实上这种情形根本没有技术解。如果一个公司在战略上不断摇摆，就表明这家公司干脆没有战略意图，那么我更建议你另谋高就。

**小结**

为什么有些架构活动会没有正确的目标？

技术上：目标缺少全局视角

- 技术同学对于先进技术的强烈好奇心
- 开发者的个人利益
- 信息沟通不畅

业务上：目标太多、不明确

- 靠 A/B 测试来决定这个方案是否要推广
- 大搞运动
- 一个公司有两个明确的目标

**思考题**

1、由于业务压力，我们经常会面临各种各样的重点项目。那么，你是怎么判断一个项目的重要性呢？怎么决定自己思考力的分配呢？注意，这里指的不是你被上级领导分配的写代码的时间，而是你发自内心觉得某件事情很重要，你主动花大量功夫去思考的过程。也就是说，你自主决策的个人注意力分配的算法是什么？

2、你或者你周围人是否曾建造过一个非常精巧的轮子，但是随着时间的推移，变成了诸多要被清理的破轮子？当时发明者有没有意识到这个轮子会增加系统的复杂性呢？为什么？

3、在你参与过的架构活动中，最让你感到兴奋的一个目标是什么呢？为什么？

# 03｜法则一：如何找到唯一且正确的架构目标？

这节课，我们就来聊聊该如何寻找正确的架构目标，以及如果目标制定错误，该如何挽回。

**如何寻找正确的架构目标？**

主要分为三种情况，我们来分别讨论。

<mark>第一种情况：确认一个正确目标，且要试图逼近它。</mark>

在做架构设计之前，我永远都会问自己这样一个问题：这个架构规划为什么可以给企业带来生存优势？

就像我作为一个 CTO 去赞助一个项目，我一般期望项目在半年内的回报要大于投入。也就是说，你投入 100 人日做一个技术项目，那你半年内就要省出 100 个人日来。否则我就不做该项目的赞助人。

显然，未来充满不确定性，终极目标很难验证，但通过反复问自己这个问题，我们就可以不断逼近这个唯一且正确的架构目标。

那么你作为一个架构师，怎么判断一个目标是不是正确的呢？我的建议如下：

1. 首先，要用企业的战略意图去鉴定架构活动目标的正确性。简单来说，就是你的 KPI 对战略意图是有正向贡献的。

   举个例子，大多数公司的战略里都对“客户第一”有着某种形式的表达。假设你的架构活动有一个作用是提升性能，比如说减少用户交互过程中的延迟和等待。那么你的架构活动在这一点上，对战略意图的贡献就是正向的。反过来，假设你的架构活动需要用户做强制性的安全身份验证，那么用户的正常体验就会被打断，这个时候，你的架构活动对战略意图的贡献就是负向的。

2. 接着，如果目标与战略意图不匹配，那么你要试图影响甚至是改变这个目标。

   我自己曾经因为三次阻止一个顶级项目，这让我自己的决策自信心得到了大幅的提升。决策自信心，才是一个架构师从架构活动中获得的最宝贵的礼物：在多个比你资深，并且比你权力更大的人面前，你坚持了不同于他人的正确判断。

3. 如果目标与战略意图匹配，那你要看看是否存在一个更合理的目标，可以让企业能够更快地逼近战略意图。

如果你能保持这么做，哪怕你不知道终极目标，但是你已经在不断逼近了。

<mark>第二种情况：关于技术驱动的目标</mark>

（架构活动没有正确的目标，原因一：技术上目标缺少全局视角）

技术人员往往缺少全局视角。在这种情形下，你可以通过引导的方式，帮他找到一个更好的方案，让他从战略角度去思考一个架构方案对公司的终极价值。 最终，找到能够最大化公司长期价值，并且成本合理可控的方案。

接着，在彻底理解新方案的价值之后，你就可以比较客观地思考这么六个问题：

1. 新方案的实现成本有多少？（短期）
2. 新方案上线后带来的短期价值有多大？（短期）
3. 这个新方案是否可以全面替代现有方案？（长期）
4. 全面替代的实施成本有多少？（长期）
5. 全面替代之后，这个新方案带来的长期价值是什么？（长期）
6. 如果不能全面替代，而是两套方案并存，那么增量的维护成本有多大？（长期）

如果拿出的方案可以完整回答上述六个问题，那就值得你去做长期规划并认真投入了。就拿我们在上节课提到的引入 Pulsar 的案例来说，要在公司内全面替代 Kafka 的成本巨大，短期内的回报完全不合理，所以提出这个方案的同学最后也觉得不合适。

事实上，大多数人在看一个新方案时，只是思考了前两个问题，然后就匆忙做了判断。要知道，这完全不能让建议者看到他的方案对全局的影响。

通过这个案例我更想强调的是：关于架构目标的决策，对于一个人或一个团队的影响是巨大的。所以当你有了一个正确的关于架构目标的决策，要知道这只是一个起点。你还要认真思考这个决策的实施路径，让大家团结在正确的架构目标上，而不是你自己一个人举着架构目标，变成孤家寡人。

<mark>第三种情况：关于业务项目的目标</mark>

（架构活动没有正确的目标，原因二：业务上目标太多、不明确）

现在我们谈另外一种情况，业务目标太多或者是不明确，从而导致架构活动目标缺失的话，你该怎么办？

我们先看一个比较棘手的案例，假设碰到上节课讲的业务方大搞运动的情形，作为架构师你该怎么办呢？

这里我们要引入两个概念：决策者和取舍权。决策权决定要什么，取舍权决定保留什么。一个决策者，必须要行使自己的取舍权，在自己的决策领域内做取舍。那么我们能做的是什么呢？至少有四件事情你可以做，注意，这是一个 Fail-over 的过程。

首先，想办法反馈这个情形，耐心解释给当初的决策者，请他来做取舍。这个本来应该是第一步也应该是唯一的一步。但是就像隔壁老王说的：“你永远也叫不醒装睡的人”。所以这个办法往往不管用。

其次，你自己做个取舍优先级，想办法通知到决策者。另外我想强调一下，通知是个非常有挑战的事情，我就见到过坚决不接受取舍的 CEO。但哪怕是这样的 CEO，他一般也会接受你给出的上线顺序。

最后，也是最常出现的情况，是你上述这些努力都失败了。这个时候，你可以通过技术手段来做延迟或者是隔离决策。这个办法对业务目标不明确的场景也同样适用。比如你可以采用类似设计模式中的策略模式，把一个或多个业务尝试隔离在策略实现中。每次业务尝试对主流程不产生影响，每个尝试逻辑都封装在单个策略中。

（前面两种太麻烦了，还是直接采用最后一种方式吧...）

**思考题**

1、请你思考一下，你参与过的某个现在看起来不太合理的架构方案，你回想一下你当时有没有思考过那个方案是否“为企业创造生存优势”？如果你思考过了，是这个原则不适用于你的案例吗？如果你没有思考过，你可以试图用这个原则检验一下这个架构方案吗，你能得出和过去不一样的结论吗？如果你发现无法使用这个原则或者不影响你的结论，你可以跟大家分享一下为什么。

2、你做过的一个宏伟的为企业带来生存优势的技术项目吗？这个项目为什么会失败或成功了？这中间最核心的因素是什么？

3、你有没有成功劝阻过一个目标错误的架构活动呢？结果是什么呢？

# 04｜法则二：架构师为什么要学习马斯洛的需求理论？

今天我们来聊聊架构师的第二个生存法则：架构活动需要尊重和顺应人性。

在架构设计中如果能尊重和顺应人性，也就是人的基本感受和合理需求，那么我们也会拥有另一个解决问题的视角，辩证思考我们正在从事的架构工作。反过来，忽略人性可能给软件架构带来致命的失误。

提起人性，马斯洛需求层次模型是绕不过去的理论。

**如何理解马斯洛的理论？**

在上世纪 40 年代，马斯洛理论被认为是心理学上的一个巨大突破，原因在于就这个模型很好地概括了人性。一般的网络文章会把马斯洛的理论解释为需求层次模型，认为高层次需求建立在低层次需求之上，低层次需求的满足是高层次需求出现的前提。

而如果我们从源头来萃取马斯洛理论，去追本溯源的话，会发现这种表述不完全正确。

如果从源头来萃取马斯洛理论，可以得到什么样关于人性的理解呢？这里有两个重点，首先是动机有优先级。

- 不是需求有层次，而是动机有优先级

马斯洛认为，人类的动机以抢占顺序依次排列（Being arranged in a hierarchy of prepotency）。马斯洛用“prepotency”这个词，特指人类的动机是依次独占人类的全部意识的。也就是说，一旦一个动机进入了这个状态，那么这个动机会召唤人的全部意识、行为去满足这个动机。我们把这个动机称作主导动机（Prepotent motivation）。

举个例子来解释说明一下，比如马斯洛动机层次的最底层，也就是生理需求动机。当一个人在生理上长期处于饥饿状态，那么这个以饱腹为目的的动机，就是他的主导动机。我特别强调一下，这个饥饿与没吃早饭那种饥饿不同，这是一种由自然灾难带来的长期的食物匮乏，是一种因为饥饿而导致死亡的、严重缺乏食物的生理状态。

在这种情形下，你整个人，包括你的视觉、听觉、嗅觉，你的思考、记忆、行为等等，都只有一个目的，那就是满足你填饱肚子这个生理需求。而这个生理动机是你所有感官、意识、行为的组织者和决策者。这时候其他的动机都不重要，你甚至都不能感受到其他动机的存在。

只有这个动机背后的需求被满足了，而且是长期被满足了，那么由更高层次需求所诱发的动机才会被解锁。因而当这个新动机开始作用的时候，它又像之前的生理动机一样，抢占你所有的意识和行为，并且压制更高层次的动机，直到它背后的需求得到完全满足。

动机抢占意识的整个过程，如下图所示：

![image-20230602223506221](https://technotes.oss-cn-shenzhen.aliyuncs.com/2023/202306022235318.png)

如上图所示，假设一个人同时存在 5 个需求，需求 1 和需求 2 已经被满足了，那么这两个需求就不会再诱发动机。而需求 3、4 和 5 没有被满足，它们会同时诱发各自的动机。但由于需求 4 和 5 诱发的动机被需求 3 所压制，因而最终是需求 3 诱发的动机，在组织和驱动这个人整体的意识和行为。

到这里你就会明白，马斯洛强调的不是需求有层次，而是动机有优先级。从某种程度上来说，诱发这些动机的需求也被传递了同样的优先级。所以把马斯洛理论翻译为需求层次理论，虽然不能说完全错误，但却没有完整传递马斯洛理论的核心观点，甚至是部分曲解了马斯洛的理论。

- 动机跃迁

接下来是第二个重点，那就是动机是跃迁的。

其实我们学计算机的应该很容易理解马斯洛的理论，它跟硬件中断的机制几乎完全相同。计算机的各种外围设备在并行着工作。当它们需要抢占 CPU 的时候，就会发出中断请求。而人类的各种需求，就相当于并行运作的外设。需求诱发的动机，就相当于对系统的中断请求。而动机就像中断请求一样，各自有自己的优先级。高优先级的中断请求，则会抢占低优先级的中断请求。

马斯洛认为，人的行为在单一时刻不是面向多目标做优化，而是面向单一目标做优化。一旦某个动机抢占了人的意识，那么它就抢占了这个人的全部意识，此时整个生命的所有思考、行为等，都在为满足这个动机而工作。那些帮不上忙的器官和能力，就被放置在后台运行了。可以说，在马斯洛模型下，主导我们人类整体意识和行为的工作机制是单线程的。

到这里，我们就可以把马斯洛理论的实质总结出来了：<mark>一般来说，人有且只有一个主导动机。这个动机由人的内在需求所驱动，并独占且主导这个人当前的一切意识和行为。直到这个动机背后的需求被完全满足之后，更高层次的动机才可能进入主导位置。</mark>

- 动机抢占

马斯洛认为心理安全感的获得主要来自于一个人的成长过程。一个人从出生起，父母会为孩子就会提供熟悉、常规和有结构的日常生活。这种安全感也在随后的成长中逐渐扩展到了相对可控的、已知的、可预测的，以及相对安全的生活和工作环境中。

一旦我们处在一个特殊处境下，比如面临战争、瘟疫等灾难，哪怕我们没有受到直接的威胁，那安全感也会丧失。在这个时候，我们生命体所有的意识和行为都在为寻找安全感这个动机而工作。

**马斯洛动机跃迁理论的核心描述和具体应用**

总结来说，马斯洛认为人的动机是内在的。这些动机来自人的不同心理需求，从最基本的生理上的需求，到心理安全感，再到群体认同感，然后是内在有底气的自尊，最后到最大化的自我实现。

如果这些需求没有被满足，它们就会刺激出人的动机，去满足这些需求。但这些动机并非同时生效，因为任何时候都只有一个主导动机在支配着我们整个人的感官、意识和行为。这些动机依次出现的顺序，如图所示：

![image-20230602224503789](https://technotes.oss-cn-shenzhen.aliyuncs.com/2023/202306022245845.png)

当生理需求得不到满足，那么源于生理需求的动机 1 就会处于主导地位，并且会屏蔽其他动机。只有生理需求得到满足了，那么处于生理需求之下的、未满足的安全感，才能诱发以获取心理安全感为目标的动机，然后成为主导动机。以此类推。

我来给你分享个经典案例——儿童的 MRI 扫描问题的解决，来看看我们可以怎样通过顺应人性来解决一个具体的问题。

MRI 的扫描过程非常慢，通常会持续半个小时，而且还要求患者必须保持一动不动的姿势。对于儿童来说，这肯定很难做到，所以给儿童做扫描的前提就是先做全身麻醉，这就让本来一个相对安全的诊断设备变得非常危险。

后来 GE 的设计师 Doug Dietz 做了一个非常巧妙的设计，他把 MRI 机器改装成海盗船的模样，并告诉孩子说你要进海盗的船了，必须一动不动保持 30 分钟，直到我们救你出来。如果动弹，就会被海盗抓走。

结果呢？孩子们非常配合。就这样，在对 MRI 成像机制和扫描流程没有做任何技术更改的情况下，全麻率从之前的 80% 降低到了 10%。

这种从共情出发，深度理解和尊重用户的做法，就是设计思维的精髓所在。之所以能提出这个方案，主要在于我们拥有了另一种看待问题的视角：

到底是被动地迭代方案，执着于填补设计的漏洞；还是从共情用户的角度出发，脱离现有技术方案的束缚。同时忘记现有的技术方案的强大，把关注点放在深度理解用户、解决用户的痛点上，进而拓展技术设计空间，找到更完美的技术路径。

答案不言自明。

到这里，在架构活动中考虑和顺应人性的必要性和重要性，相信你已经很清楚了。那么接下来一个更为重要的问题就是：在软件架构活动中该如何顺应和考虑人性呢？

**思考题**

1、在马斯洛的理论中，自我实现是个内在的目标，是由个人决定的，但这个内在目标会影响整个社会的产出。假设社会存在某种有效的手段可以干预这个目标的话，你认为社会应该干预吗？举个例子，假设达芬奇不花那么多时间作画，他有可能成为一个更伟大的科学家。或者他不花那么多时间去研究科学，他有可能成为一个更伟大的艺术家。如果社会能干预达芬奇的选择，你认为社会应该干预吗？你介意被他人干预吗？

2、能否举一个在你身边发生的、违反了马斯洛理论例子？它为什么会发生呢？

3、大胆假设一下，在后人工智能时代，如果我们人类（被）进化成了机器与人的混合体，其中机器也有它的需求（比如没电了要充电），那么你能想象一下，这种混合体会有什么样的需求呢？我们该怎么设置这些需求的优先级呢？

# 05｜法则二：研发人员的人性需求是如何影响架构活动成败的？

上节课我们学习了马斯洛关于人性的理论，那么这节课我们就利用这个理论来看看我们在架构活动中应该注意些什么。

架构设计必须符合人性，而在架构活动中，与“人”相关的主要就是研发人员和目标用户。那么今天这节课我们就先从研发人员讲起。

想想看，如果架构设计忽略或剥夺了研发人员的人性，会怎样呢？再一个，如果架构活动中尊重和顺应了人性，那么又能给我们架构师一个怎样不同的解决问题的视野呢？这正是我们接下来要讨论的内容。

**研发人员为什么需要安全感？**

环顾四周，你会发现研发人员对安全感的需求很是强烈。内卷、35 岁危机、996，各种流行关键词似乎都指向了安全感的缺失。为什么会这样呢？

这个问题可以用马斯洛理论来回答：因为我们都吃得太饱穿得太暖了！我们
的生理需求得到了充分的满足！这么一来，心理安全感的需求就赤裸裸地暴露在那里，等待着被满足。

研发人员的生理需求是能够在软件架构考虑范围之外得到充分满足的，那么根据马斯洛的理论，如果一个研发团队，本来是具备心理安全感的，但是突然间却被剥夺了，这会导致什么问题呢？

答案是：没有人性的技术架构，就没有生存空间。

**没有人性的技术架构，就没有生存空间**

接下来，我们就通过一个案例来演示一下，研发人员的心理安全感被破坏之后会造成什么损失。

先来说说案例的背景。

我曾受邀给一个在行业内处于垄断地位的大企业做架构规划的外部评审。这家企业的技术在自己所处领域内领先全球，加上资金雄厚，因而他们开始在海外做布局，投资了一家同领域的初创公司。

本来小公司有自己的研发人员，且初步建设了自己的技术体系，基本可以支持本国的业务。但在大企业看来，这家小公司的技术落后自己几年，而且研发人员的能力也有限。在这个背景下，大企业的国际化团队提出了一个架构设计，如下图所示：

![image-20230604225134708](https://technotes.oss-cn-shenzhen.aliyuncs.com/2023/202306042251812.png)

投资前，小公司有自己的完整技术栈，如图中左边部分所示。但投资之后，大企业期望小公司能把他们的技术迁移到一个由自己开发的技术平台上去，这样大企业的部分技术就可以通过平台输出给这家小公司了。

这个技术平台主要包含两部分：一部分是全球业务网络和支持这个业务网络运作的全球技术平台，也就是图中的最底层部分。另一部分是一个通用的本地技术平台，由大企业开发，全球通用。这是图中右侧位于全球网络上面的部分。

如果将小公司的技术迁移到本地技术平台之后，他们的研发团队就可以集中关注怎么在本地技术平台上开发自己国家的解决方案。这样一来，之前做本地平台功能的研发人员可以减少很多。而且由于对本地解决方案开发者的技能要求相对更低，这样的研发人员很容易找到，那么用人成本也低。

此外，这样做还有几个附加的好处。

首先，大企业开发的本地技术平台基于全球最先进、业务体量最大的中国市场的技术建设，所以不但技术先进，而且附带了很多海外同行们还没有开发出来的技术能力。

其次，本地技术平台和大企业的全球业务网络是打通的，所以小公司一旦接入本地技术平台，那跟它就和全球业务网络一下子就完全打通了。额外的生意滚滚而来，成本又少了很多，何乐而不为呢？

但结果呢？

一年后，大企业投入几千人终于建成了这个庞大的系统，也大幅扩招了在海外的投资版图，但能接受这个方案的小公司却寥寥无几。第二年， 大企业又做了一次全面的技术升级，放宽合作条件，增加对部分小公司的投资占比，但技术方案的推进和被投资业务的增长都不尽如人意。又过了一年，这个方案最终被取消了。

四年后，行业蓬勃发展，但大企业投资的小公司完全没有像期望的那样复制了大企业在国内的成功。不算小公司侧的研发损失，仅大企业损失的研发资源就达到了 1.5 万到 2 万人年，再加上直接投资，损失高达几十亿美金。这还不算浪费掉的机会成本。

**忽略研发人性的架构设计，会怎样呢？**

为什么会造成如此惨重的结果呢？

因为这个架构设计完全忽略了人性。具体来说，就是这个架构方案完全忽视了小公司里研发团队的心理安全感需求。

想想看，如果你在小公司任职，你研发了第一代技术，让公司被一个资金雄厚的国际化大企业看中。但随之而来的就是把你辛苦开发的代码全部下线。紧接着，你的日常工作就变成了跟第三方供应商做系统对接，与核心技术失去了接触。这个方案一旦采用， 那么一夜之间，从 CTO 到一线研发，每个技术人的安全感都被一扫而光。这个时候你还会安心地留在公司吗？

在这个软件开发人员相对能够保障衣食无忧的年代，没有比获取心理安全感更高的动机了。

现在你应该知道了，获取心理安全感必然会成为小公司研发人员的主导动机。假设你在小公司工作，在拿到技术方案后，你的第一优先级会是去完成技术迁移吗？哪怕有股权和激励诱导你这么做，你会全身心地投入其中，保障迁移迅速完成吗？ 至少马斯洛不这么认为。

虽然从技术角度来看，这是个非常有价值的架构方案，但这却是一个完全没有人性的架构。一个完全忽略了研发视角的设计，不但没有从共情出发，甚至是践踏了人性。那么这个架构在海外屡战屡败的事实也就不证自明了。

因而这个例子告诉我们，你作为一个架构师，设计的方案必须要尊重研发同学的人性，一个完全忽略人性的架构是没有生存空间的。

现在让我们再次强调一下今天讲的生存法则：架构活动需要尊重和顺应人性。架构师必须洞察研发人员的人性，在方案设计和架构活动组织中充分考虑研发的人性，才能保障方案的正确性，以及方案的高效实施。

# 06｜法则二：拼多多是如何通过洞察用户人性而脱颖而出的？

我们都知道，软件这个虚拟的存在最终是要服务于用户的，所以在软件设计的过程中也要考虑用户的人性。也就是说，一个架构师要站在用户的角度去思考架构的规划和设计。

**从人性看拼多多是怎么赶超阿里的**

这里面有很多因素，比如说线上支付、微信流量。但其中至少有一个关键因素和马斯洛的人性理论有关：拼多多对用户人性的理解，远远超越了其他同时期的电商玩家。

拼多多创始人黄峥在《财经》杂志的采访中说了这个洞察：“我们的核心不是便宜，而是满足用户占便宜的感觉”。

我再重复一下第四节课讲的马斯洛关于主导动机的描述：一旦一个动机进入了这个状态，那么这个动机会召唤一个人的全部能力去满足这个动机。这时候这个动机就是主导动机。

那么在拼多多这个例子中，占便宜的心智就会诱发具备抢占性的主导动机。

**从用户心智到增长飞轮**

那么你作为一个架构师，理解这个人性有什么意义呢？

从我的观察来看，很多创业公司，从初创到倒闭，都没搞清楚自己的目标人群和心智。如果一个公司，能锁定目标人群及其心智，那么对于软件架构师而言，你就有了一个确切的技术问题和研究方向。这可能是一个架构师最梦寐以求的工作处境。

我们先来看下面这张图：

![image-20230605215316038](https://technotes.oss-cn-shenzhen.aliyuncs.com/2023/202306052153156.png)

图中的每条连线上都有一个角标“+”号，如果前项的增长会带来后项增长，那么箭头上也用“+”号表示。你会看到整张图上都只有“+”号，这就代表整个平台机制形成了正循环。也就是说，随着时间的推移，价值在不断放大。这是系统论的正反馈循环，也就是大家经常提到的飞轮效应。

一个架构师，如果你能尽早看懂看透你公司的用户心智，那么你就可以在技术上提前布局，从用户思维出发，扩大你的技术搜索空间，最终为公司创造更大的价值。

**思考题**

1、设计思维其实无处不在，我认为 Hive 其实也是一个设计思维的好案例，你能理解我为什么这么认为吗？除了 Hive，你能举出其他可以体现设计思维的好例子吗？

2、到这节课为止，我们已经完成了对马斯洛人性理论的学习。你能够举出你身边或者是观察到的一些好例子吗？通过这三节课的学习，你有没有什么新的启发？

3、你有没有发现你与身边某些人存在一些明显的认知差距？你是用什么手段缩短这个差距的呢？

# 07｜法则三：架构师如何找到自己的商业模式？

今天我们要讲的是架构师的第三个生存法则：作为一个架构师，必须要在有限的资源下最大化架构活动所带来的商业价值。对于任何一个架构活动而言，架构师的可用资源，包括商业成本、研发成本、时间成本、迁移成本等等，都是非常有限的。但架构活动就是要在这些限制条件之下，将商业价值最大化。

**什么是商业价值？**

商业价值 (Business value) 呢，就是从现金收入的视角看价值创造的过程。你每天忙碌的工作，从企业的收入上来说，可以为公司带来什么样的短期和长期现金和其他收入，那么对这部分收入的量化，就是你创造的商业价值。简单来说，商业价值就是帮助公司获取商业收入。

我会把第三条生存法则分为五个部分来讲：

1. 理解你所在的企业或团队的商业模式；
2. 理解你在自己所处环境中创造的商业价值；
3. 保障架构活动的长期商业价值；
3.  在架构规划中寻找扩大收入的机会；
3. 在架构规划中寻找减少成本的机会。

**理解一个企业或团队的商业模式**

比如说天猫这个电商平台，它的主要收入来自于交易抽成：

```
总收入 = GMV * Commission
```

网站的交易额越大，抽成就越多。网站规模越大，总收入就越多。

但到了不同的细分领域，每个领域的商业模式，就会分解成不一样公式了。比如说你负责天猫平台的一个由算法驱动的购物频道，那么你们的商业模式可能是这样的：

```
GMV= 流量 * 转化率 * 平均订单金额
```

如果你负责天猫平台某个垂直行业的招商团队，那么你们的商业模式可能是这样：

```
GMV= 日均动销店铺数 * 店铺日均销售额
```

如果你负责某个垂直行业的大商户运营团队，那么你们的商业模式可能是这样：

```
GMV= 活动参与次数 * 平均计划销售额 * 计划达成率
```

如果你负责商品团队，那么你们的商业模式可能是这样的：

```
GMV= 动销商品数 * 订单数 * 每订单件数 * 件单价
```

**理解自己所处的工作环境**

一个以客户为导向的团队，他们的首要目的不是听从上司的声音，而是去倾听客户的声音，从客户的需求中寻找自己能够创造商业价值的地方。所以这样的团队，绝不会靠公司的拨款过日子，他们的收入必须源自为客户创造的真实的商业价值。

这就是为什么越是受公司大力赞助的项目就越难存活的道理。

如果你活在一个靠公司拨款而生存的部门，那么你学习到的能力是有限的，因为你们部门从上到下都不是在求生，也不是为客户创造价值，所以你也学不到真正的生存技能。

==我们每个人都要有自己的商业模式。==你必须在工作环境中找到创造价值的方式，这样才能保障自己一直被需要，也能保障未来的收入。

这里面有两个关键元素。第一是增量价值，就是你通过工作所创造的价值，是在社会提供的平均价值之上的。

举个例子。2010 年之前，如果你是一个做微服务框架的高手，那你的增量价值就非常大，一个人能顶十个甚至一百个研发。因为那时候开源的微服务框架还不够成熟。但到了今天，如果你还是单兵作战，擅长写微服务框架，那跟开源的 Spring Framework 相比，你提供的增量价值可能就是一个负数了。因为团队剩下的同学还要花时间来学习、使用和维护你写的框架，公司也要为这些同学付出工资成本。

虽然你的工作没有变，但社会提供的开源解决方案的价值增加了，那你的增量价值相应地就会减少，甚至不存在。

第二个是可度量性。把自己的工作放到我们刚才讲的公式里去。假设你是做商品相关的技术，那么：

```
GMV= 动销商品数 * 订单数 * 每订单件数 * 件单价
```

你需要度量的是，你的工作对公式中的某一项或某几项会起到什么促进作用。

# 08｜法则三：架构师如何在一定时间内最大化自己的增量价值？

作为架构师，该如何为你的公司、部门或团队提供可量化的增量价值呢？主要有扩大收入与减少成本两种路径。今天这节课，我们就结合几个真实的案例来具体分析一下。

**如何寻找扩大收入的机会？**

你可能听说过“在小数据里看大机会，在大数据里看小机会”这句话，这其实适用于我们所有技术人。

前半句指的是从个性需求中抽象出共性的机会。也就是从解决一个具体问题的过程中得到启发，并从中找到一个可以规模化应用的机会。比如做用户调研时，你发现有一个用户总是截图之后再通过微信把商品发给另一个人。那么你就会意识到，可以开发一个分享工具，通过小程序和 DeepLink 来获得更多的社交裂变。

后半句指的是靠数据来打磨用户体验。也就是通过数据分析找到机会点，然后通过产品和技术的改进，不断提升转化减少损失。这是算法和数字化运营的常见办法。比如淘宝 App 的首页跳出率是 2%，就是通过数据分析和打磨而不断提升的。

我特别强调一下前半句。事实上，很多著名的开源框架都是这么来的。离我们最近的一个例子就是 Docker。

虽然现在的 Docker 已经没有它如日中天时那么辉煌了，但毫不夸张地说，今天整个云原生生态的存在，引爆点就是 Docker。但谁能想到，Docker 最初只是为了解决一个环境打包问题呢！回想一下，从你进入计算机领域以来，你见过几个程序员会把心思放在运行环境打包上呢？

这个案例给我的启发就是，很多非常成功的技术人，他们往往就是看到了别人忽略的小痛点，或者在别人不去排查的小异常上执着探索，才最终跨越了现实的障碍。

**如何寻找减少成本的机会？**

一个公司在做商业模式探索的过程中，跟一个人要向前冲刺是一样的，都需要消耗能量。只不过对于一个公司而言，这个能量是钱。一旦钱耗尽，公司就饿死了。

所以作为一线的架构师，哪怕你不清楚公司的财务状况，但你的任何架构动作，都要考虑公司的研发成本，确保团队的规模在公司财务状况的允许限度之内。这也是经济学中所说的成本观念。

其实这种成本观念公司上下每个人都要有。对于一个公司而言，一切有限资源上的消耗都是公司在架构活动中要付出的成本，比如时间成本、人力成本、机会成本、计算成本等。

分享一个我的经历。08 年美国发生次贷危机之前，我从耶鲁大学招了一个满分毕业的计算机系硕士生。他工作勤奋，产出也很好。但没过多久，公司就因为营收压力要强制裁员。由于他的入职时间最短，最终决定只能裁他。

他出生在印度一个普通家庭，从印度理工计算机系毕业后，又考到全球顶尖学府，这一路的艰辛可想而知。然而现实就是，在美国全职工作是拿绿卡留在美国的前提，我们一旦终止合同，那他只有几天时间去找工作。在经济危机发生的时候，这几乎是完全不可能的事情。

那两天公司上下都在裁员，当我叫他进办公室时，他已经预感到要发生什么，整个人都快虚脱了。他苦苦哀求，我都不知道该怎么回复他，只能沉默以对。这么多年了，我现在一闭上眼，还能想起他那一刻流露出的绝望眼神。

我分享这个故事，就是期望你知道，控制成本不是为了老板，而是为了我们自己。假设你总是以又大又笨重的系统去应对，那么在公司出现困境、经济出现低谷的时候，你的团队或企业可能就不复存在。相应地，架构师创造的软件也就不复存在，个人收入也会受影响。

从更理想化的角度来说，这么做也是为了自己的良心。我虽然无法预测未来，但在面对印度同事那一刻，内心还是非常自责。既然我不能给他一个稳定的任职机会，为什么还要让他加入？我的团队如果大幅盈利，那我不但不用裁员，说不定还可以收留其他员工。说到底还是我没做好。

最后那个被裁的印度同事怎么样了。当他走出我的办公室后，我整个人都要崩溃了。我在我们整个楼跑上跑下，挨个敲每个研发管理者的门，告诉他们这个同事有多优秀，裁员对他来说打击会有多大。我跑了一下午，没有得到任何回复，原本都绝望了。

但是下班前有个主管来找我，说他团队里有个同事知道来龙去脉后，决定在那天下午提前退休，把自己的位置让给印度同事。这位印度同事后来在这个团队工作了很多年，我们也一直保持着友好的朋友关系。

这个世界还是有很多善良的人的，我期望你能记住这个故事，善待你周围的人。

**思考题**

能否分享一个你经历过的通过技术创造商业价值的案例呢？请注意，在分享这个案例的过程中，我建议你多强调这个技术突破点是怎么被发现的，具体的技术细节反倒可以讲得概括一些。

# 09｜法则四：为什么要顺应技术的生命周期？

人类的各种活动都要遵循事物的客观生命周期。不论是农业社会种田打渔，还是资本社会投资创业，行动太早或太晚，都会颗粒无收。技术也一样，也有自己的生命周期。而我们作为架构师，如果看不清技术的生命周期，那么所设计的架构就没法儿向更有生命力的新技术借力，自己的职业生涯也会受限。

在架构设计的过程中，架构师会有一个相对确定的商业和技术选择空间。在这个选择的空间内，架构师做技术选型的时候，必须要考虑到所依赖的商业和技术模块的生命周期。这个时候，我们就需要看准技术趋势，选择已经有规模优势或者是即将有规模优势的技术，而不是选择接近衰老期的技术。

但是啊，有的人能够看准一个技术的生命周期， 而有些人却做不到。为什么？

**看准技术趋势为什么难？**

我和身边许多做技术的同学，多数时间都在看小尺度的问题，日常工作和注意力都放在需求实现、领域建模、平台重构、中间件升级之上，因此我的思考也被这些工作所主导，很少去思考五年、十年，甚至二十年的技术趋势。我们不关注，当然也谈不上如何利用技术周期了。

技术的生命周期就像是潮水。潮来，汹涌澎湃，绵绵不绝。潮去，风平浪静，滩涂尽显。人一生的黄金岁月中也就是几个浪头而已。就过去 40 年而言，真正大的技术浪头有个人电脑、互联网、移动互联网、AI，差不多是每十年一个。你要在这种技术大浪潮之上玩好冲浪，就必须看清楚浪头，准确把握好技术方向和入场时机。如果错过，再等新的一个技术周期，几年的黄金岁月就浪费了。

我不认为自己真正看准过这些趋势。事实上，我也没能借到浪头的最大势。我分析原因，是因为存在着三个人性上的弱点：

1. 自我麻痹，以繁忙的重复工作来代替深度思考；
2. 畏惧变化，以最小化改变来维持自己的心理安全感；
3. 路径依赖，以过去的成功经历来应对未来案例。

**让我们放弃思考的三大弱点**

- 弱点一：自我麻痹

自我麻痹是指我们用各种方法让自己放弃思考和探索的欲望。

对于大部分互联网从业者而言，从小到大都是学霸，内心不太能接受自己不思进取。于是进化出了一个自我保护机制，让自己每天都忙起来，用勤奋来弥补内心的不安。这就导致我们不能全力去探寻新的出路。

其实麻痹自己越久，就越是难以突破。越没有突破，就越是没有去突破的勇气。陷入一种恶性循环。

我们只有承认和面对现在的风险，才有勇气放弃麻痹自己的行为，把部分注意力从当前技术放到更新、更有颠覆性的技术上去。而不是被动地等着他人告知自己下一步需求。

- 弱点二：畏惧改变

马斯洛模型提到：心理安全感的需求导致我们会畏惧改变，这是我们与生俱来的本性。

前段时间有位技术人员给我分享他稳定性治理的经验，他描述了如何通过一个独立的运维团队，把一组很烂的微服务运维到接近五个九。我很诧异，他们直到现在竟然还在使用独立于研发的运维团队，来保障公司核心系统的稳定性。

后来追问细节才知道，这家公司连续几任 CTO 都没做过互联网高可用架构。因为这个核心服务是公司营收路径上最重要的一环，所以连续几个 CTO 都不敢大兴土木，从根本上解决这个服务的稳定性问题，而是通过运维的方式先顶着。这一顶，就是 4 年多！

畏惧改变，让这个团队从 CTO 到架构师，再到一线主管，都丧失了稳定性治理的勇气。直到现在，这家公司还在沿用几年前自研的微服务框架，而没有引入当下常见的 Spring Framework，也没采用 Service Mesh。从头到尾都是一套年久失修的老系统， 离开的人越多，懂的人越少，就越没有人敢改动。现在，公司只能靠大量的全职运维团队来续命，以至于风险稍大的发布，还是要运维团队来做。

其实我们都一样，一旦赌注足够大，就会产生畏惧。我们率先放弃了改变的勇气，跟着就会放弃改变的欲望。得过且过，离新的技术趋势越来越远。

- 弱点三：路径依赖

所谓路径依赖，就是你被过去的成功所蒙蔽了，以为过去的成功可以复刻。当过去的成功路径成了你唯一的选择，那么你也不会关注，更不会去探索新的路径了。

几年前有个同学转岗到我团队。他之前在一个大部门里做基础架构，曾经做过合并部署，就是把几个相关的微服务部署在同一台虚拟机，甚至是把几个微服务合并成一个巨石服务，然后部署在同一个 JVM 上。

这么做其实是个反模式，虽然会减少网络开销，提升性能，降低计算成本。但实质上，这个过程是用长期的运维和人力成本来替换机器成本。要知道，机器成本和网络带宽，在今天还基本符合摩尔定律。所以通过不断增加人力、维护和迁移成本，去替换每两年就减半的计算成本，这么做是不理智的。事实上，更大的成本是机会成本，这种巨石服务会增加升级改造的难度。也就是说，会让一个企业，很难快速响应新机会和新的竞争。

不过在他之前遇到的场景下，这样做的确可以带来实实在在的短期回报，所以他在之前的团队得到了很大的认可，也因此得到了晋升。同时，他也为自己的成就感到自豪。但我所在部门的 BU 的计算量，远远低于他之前的大部门，峰值流量还不到他们的百分之一。这么一来，虽然开发成本一点儿没少，但做合并部署的回报却远远小于他之前的工作场景。

而这个时候，Kubernetes 已经开始暂露头角。Kubernetes Pod 加 Docker Image 就已经可以非常完美地解决合并部署能解决的大多数问题了。但这位同学，因为有了之前的成功经验，根本没有去探索合并部署之外的解决路径。结果他的项目进行到一半，大家意识到 K8s 才是更合理的解决方案，所以他的项目也就草草收场了。

这就是路径依赖。如果我们被某个史诗级的训练样本冲击过，都会过度相信自己过去成功或失败的经验。这会让我们看不到其他的技术可能，更别说新的技术趋势了。

**如何克服人性的弱点？**

先分享一下我的办法。我并不觉得这些办法好在哪里，但有必要分享我在克服这些弱点上所做的努力。

首先，日常工作中我也经常会麻痹自己。不过我跳出这个状态的办法就是，每年会留出两次深度忏悔的时间。我会放下当前所有事情，回想过去半年是不是做错了什么，有没有获得什么本质上的能力提升。半年后，如果发现自己还是同样沮丧，那么我就会琢磨，是不是要逼迫自己找个更有压力、更能成长的事情和环境了。

这就到了第二点，克服内心的恐惧，迎接变化。这一点我天生要比很多人好。虽然在变化来临的那一刻还是会有很大的恐惧，但与此同时，我又无时无刻不在期待着变化。不止在工作中，生活中也是一样。随性的探索和意外的惊喜，总会带给我更大的乐趣。如果说我不恐惧变化，那完全是胡扯。但我会用对获取惊喜的期待，来压制内心的恐惧，这个办法对我一直很有效。

路径依赖最难破。我记性还不错，表达能力也比较强，而且我也经历过很多波折。但到了后来带团队时，就发现这些特性看起来是优点，其实会放大我的路径依赖。

比如面对一个相对来说经验没那么丰富，表达能力没那么强的同事。我能够及时召回重点案例或个人经历，然后把逻辑准确表述出来。这个时候，我会更容易说服周围同事，导致我的建议更占上风。这个问题在我刚开始做 CTO 时变得非常严重。因为大多数参会者是我的下属或同事。他们可能不愿意反驳我，甚至哪怕是我错了，也不一定会纠正我。

我意识到这种情况之后，就开始刻意让自己更关注那些想法独特，或者是经常挑战我观点的人。比如下属反对我的话，如果我们各自的逻辑都很严谨，仅仅是假设有所不同。那么我表达观点之后，就会强迫我放弃自己的立场。

这么做，一来可以防止我有路径依赖，二来也是为了培养下属，让他们有足够的决策空间和犯错空间。这样一来，他们不犯错，我就有成长。他们犯了错，他们自己就有了成长。两全其美，何乐而不为？事实上，在这个过程中，我发现了非常多优秀的人才。我相信他们中间有很多人的思考和成就必然会超越我。

假设没有这些弱点阻碍你探索技术趋势，那么我们就可以试图通过热度曲线来比较客观地分析技术趋势了。

**如何通过热度曲线看技术生命周期？**

如下图所示，是热度曲线（Gartner Hype Curve）。它是对新技术流行趋势的一个比较不错的建模。我们身边大多数技术的发展，其实都基本符合这个曲线。

![image-20230608224242716](https://technotes.oss-cn-shenzhen.aliyuncs.com/2023/202306082242819.png)

如图所示，横轴是时间，竖轴是流行热度。发明者 Gartner 把一个技术的周期大致分为五个阶段，分别是：

1. 萌芽期 （Technology Trigger) ：指的是技术被公开，媒体热度陡然上升，还没有成型
   的产品和商业应用场景。
2. 至捧期 （Peak of Inflated Expectations) ：指的是有了一些成功案例，当然也有失败
   案例，技术被吹捧到了极致。
3. 低谷期（Trough of Disillusionment）：这个时候，热度回归到理性，失败案例被放
   大。如果产品不能让早期受众满意，那么技术就会在这个阶段消亡。
4. 灵感期（Slope of Enlightment）：产品逐渐找准在行业的价值定位，二代三代产品出
   现，产品逐渐出现理智的商业用户和成功案例。
5. 产出期（Plateau of Productivity）：在这个阶段产品被主流市场认可和采用。

其实我们身边大多数的技术，都活不到产出期。其实能活到至捧期的技术，也寥寥无几。Docker 是一个非常符合 Gartner 曲线的经典案例。

在产出期之后，技术还有两个状态：

1. 衰老期（Progressive Aging）：以该技术为基础的产品，已经逐渐开始被下一代的新
   技术所替代，产品的市场范围和利润逐渐被蚕食。
2. 退出期（Fade Out）：产品已经完全退出主流市场，仅仅在一些场景契合度与替换成本
   都非常高的情况下，还在被维护和使用。

那么我们从这条曲线的描述中能得到什么结论呢？

结论就是：所有的技术都像人类的生命一样，也有终结的一天。这是个自然规律。从架构师的角度理解这句话就是：一个老去的技术就让他老去，快死的架构不值得投入人力和时间去维护，更不用说去翻修或者是复用了。

我曾经反复思考过，怎样才能避免让一个老的技术和架构侵入到新的体系里来？硅谷达人Guy Kawasaki 曾总结苹果公司 Macintosh 的成功，他认为关键就在于“低调加物理隔离”。我觉得这也应该是这个问题的答案。那就是把这种新的项目和公司其他部门分割开来。参与的人少一些，时间给宽裕一些，尽量远离公司的核心业务和人群。

我们也可以运用之前在尊重人性这个法则里提到的用户思维，来引导团队放弃一个衰老的技术。因为曾经再伟大的技术，在用户的面前都是渺小的。为了更好的用户体验，一切都值得推倒重来。

**小结**

其中我特别想强调的是，当你把自己的思考尺度从三五个月扩大到五年或十年，那么这件事情的价值必然会很大。这个放大思考尺度的动作，会让你用不一样的视角来看待技术。

看一次看不懂，看两次看不懂，但是看多了，自然会看出门道来。从本质上讲，这是个算法训练的过程。当你老用一个小尺度的样本来训练自己的大脑，那么你的大脑就是一个非常优秀的小尺度决策机。但当你坚持用大尺度的样本来训练自己的大脑，那么你在大尺度问题上的决策质量，也必然会得到提升。

作为一个架构师，知天道不够，还是要顺天道，也就是说我们的架构要符合技术的自然周期。反之，为一个落后的架构注入新生就是不符合天道了。而想要抗拒这种行为，我们就要从用户思维出发。为了更好的用户体验，要舍得放弃任何曾经伟大过的技术。

**思考题**

1. 除了我分享的三个弱点外，你觉得还有其他弱点会影响我们看更大尺度上的规律吗？你是怎么克服这个弱点的呢？
2. 你是如何看待当下比较流行热词呢，比如云原生、低代码、响应式编程、元宇宙，你怎么看这些技术的趋势？
3. 你或者你周围人，有没有还在维护那些已经在业界垂死的技术？你认为其中的根因是什么呢？

# 10｜法则四：架构设计中怎么判断和利用技术趋势？

**技术未来的趋势，谁主沉浮？**

你有没有想过，到底是谁决定技术的未来呢？其实大多数人都不决定技术的未来，哪怕是雷军，他也在思考该怎么顺势而为，“于万仞之上推千钧之石”。那么，技术大趋势的推动力来自哪里呢？

我认为技术真正的推动力来自市场，需求规模决定技术走向。这由经济规律决定，不以个人意志为转移。哪怕一个头部大厂，也不能完全决定技术的未来，而是市场规模和成本结构决定技术发展的走势。

那么细分到我们关心的软件架构，它的发展来自市场的三个核心推动力，自底向上分别是：硬件技术发展、软件行业的竞争格局，以及垂直行业的商业模式的进化。越往上，距离我们越近，迭代得也越快。

我们先从软件发展的最底层的推动力——硬件发展讲起。

**从硬件技术发展看软件架构的未来**

<mark>首先，硬件技术进化的驱动力是需求规模。</mark>计算机硬件技术从巨型机、大型机、小型机，到 PC、Mobile 的进化过程，就是市场需求规模的增长过程。随着市场需求规模越来越大，就会有越来越多的技术创新参与到规模效应中来。

这种有规模效应的技术创新几乎是赢家通吃。而市场中最后剩下的玩家，很少会超过两个。一般是领先的玩家开发主流技术，来服务主流用户和主流场景。而略小的那个玩家，则去服务主流技术覆盖得不够好的边缘场景和小众用户。

<mark>其次，硬件技术的进化来自驱动用户侧的体验变革，再传递到软件的变革。</mark>从商用小型机到个人电脑，从 Mac 到 PC，从 iPhone 到 Android Mobile，都是某个硬件厂商先做大，然后硬件厂商对市场份额的争夺决定软件的走势。

这也是为什么我说硬件变革是软件行业的前置量。它在提醒我们，虽然我们是软件架构师，但关注硬件侧的变革很重要。顺便说一句，当下很火的元宇宙也符合这个规律。Nvidia 先做大，大量量产的 GPU 寻找增量市场，试图吹大元宇宙这个泡泡。接着 EPIC、Facebook 和 Microsoft 入场。

那么怎么关注硬件呢？

在硬件生产一侧，规模效应和出货量的关系很大。其实这个关系非常普遍，几乎适用于各行各业。相比厂房，流水线上移动的单个产品，甚至是工人的成本，都可以忽略不计。一旦流水线建好了，就必须开足马力使劲生产，这样才能靠量产带来规模化的利润回收。

对应到我们软件架构的规律就是：计算设备的出货量决定软件架构！因为单个计算设备的定价基本是由出货量决定的。计算设备的价格决定软件的计算成本，而软件架构必须建立在合理的计算成本之上。

过去二十年分布式计算的架构就是这个规律的一个实例。本来分布式软件开发的成本要远远高于单机软件的开发成本。但是当低成本算力和高网络带宽同时出现时，分布式计算的硬件和分布式软件开发加在一起的总成本，就远远低于单机计算和单体软件开发的总成本。而算力因为摩尔定律和尼尔森定律的缘故，在不断以指数级别扩大规模优势，所以就驱使全社会对分布式操作系统和计算有了大量投入。这些投入的结果就是分布式架构最终胜出。

在硬件行业的竞争上几乎永远是出货量为王，尤其是产品价格远远高于原材料价格的半导体行业。不过靠出货量而最终竞争胜出在半导体之外的行业也适用，国内电器和电子设备制造业就是个不错的例子。根据这个规则，<mark>我认为在架构设计上，要尽量寻找利用和放大规模效应机会，保障开发软件所带来的价值在规模增长的过程中不断变大。</mark>

总结一下：软硬件都具备规模效应，最终出货量最大的玩家会以更低的价格和更好的质量赢得市场，而硬件的发展往往会左右软件架构的走向。最终软件架构必须要利用好规模效应。

**从“神仙打架”看技术趋势**

软件行业内的竞争，则是软件架构技术发展的第二个核心推动力。

我们大多数人都不为一个决定技术趋势的大厂工作。即便我们为这样的大厂工作，往往也不处在决策位置上。从个人角度看，这些决定技术趋势的大厂就像神仙一样。民间有言：“神仙打架，凡人遭殃。”言外之意就是，神仙要真是打架了，你躲得越远越好。

神仙打架的玩法其实也逃不出竞争的普遍规律，不外乎我们老祖宗讲的合纵连横。我们就用云计算 AWS 和云原生基金会 CNCF 的竞争来举例吧。

在云计算领域，亚马逊有非常大的先发优势。它在 2006 年正式发布 AWS，比竞争对手微软发布 Azure 早了两年。事实上，微软真正投入到云计算领域的时间更晚，要到 2010 年。而谷歌真正投入到云计算要到 2012 年。所以这么长的时间，给了 AWS 足够长的市场渗透期。这就导致在很长一段时间里，谷歌和微软都没办法缩小他们与亚马逊之间的差距。

直到 2013 年容器技术 Docker 的出现，竞争突然出现了转机。Docker 的革命性就在于它用一个轻量级的方法，完美解决了发布和运行环境的兼容性问题。任何研发人员都能以极低的成本，与另外一个研发在云环境下合作。

谷歌和微软意识到这是他们撕开 AWS 封闭式云计算环境的一个机会。所以 2014 年，谷歌不惜把自己珍藏的核武器 Kubernetes 拿出来，让大规模的云上和跨云的调度成为可能。与此同时，也开始加速在 Cloud 的投入。在这之后，谷歌和微软在云上的竞争有了明显转机。

不过革命者 Docker 只是昙花一现，它的实力根本没办法和 AWS 抗衡。毕竟桌上玩家的赌注是以百亿美金计算的，所以大家最后还是团结在了一个非常包容（Inclusive）的开发标准的周围，那就是 CNCF。

CNCF，尤其是 Kubernetes+Docker，事实上给了云计算以开放性和互联互通性。也就是说，不是像谷歌或微软这样的单个公司在与亚马逊竞争，而是一大批的开放生态参与者联合起来与亚马逊 AWS 竞争。

结果会是什么样呢？一般来说，开放生态在长时间竞争的过程中，会胜过封闭的单个公司。那么这对我们架构师意味着什么呢？这意味着，我们要把架构依赖在你认为的那个赢家身上。

**从商业模式看技术未来**



**看清楚技术发展周期之后**



**思考题**

1、Nvidia GPU 架构会完胜 Intel 架构吗？为什么？如果可以完胜，那它对服务端架构会有冲击吗？在这个趋势之下，你认为未来的云计算会发生什么变化？

2、前些年国内不少大厂炒作混合部署，你认为这么做的价值在哪里？从长期来看，这是个合理的战略吗？你也可以把“合作部署”换成其他比较流行的技术来谈，比如 Event Driven Architecture、低代码、响应式编程。

3、最近两三年里，你认为最大的硬件行业突破、软件竞争格局变化或商业模式变革是什么？这个变化会对未来的技术产生深远影响吗？为什么？













